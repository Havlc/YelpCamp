'use strict';

<<<<<<< HEAD
const getDiscriminatorByValue = require('./getDiscriminatorByValue');
=======
const getDiscriminatorByValue = require('../../queryhelpers').getDiscriminatorByValue;
>>>>>>> e850dbdd69512603c0d4d12d8d93e241262e32af

/*!
 * Find the correct constructor, taking into account discriminators
 */

module.exports = function getConstructor(Constructor, value) {
  const discriminatorKey = Constructor.schema.options.discriminatorKey;
  if (value != null &&
      Constructor.discriminators &&
      value[discriminatorKey] != null) {
    if (Constructor.discriminators[value[discriminatorKey]]) {
      Constructor = Constructor.discriminators[value[discriminatorKey]];
    } else {
<<<<<<< HEAD
      const constructorByValue = getDiscriminatorByValue(Constructor.discriminators, value[discriminatorKey]);
=======
      const constructorByValue = getDiscriminatorByValue(Constructor, value[discriminatorKey]);
>>>>>>> e850dbdd69512603c0d4d12d8d93e241262e32af
      if (constructorByValue) {
        Constructor = constructorByValue;
      }
    }
  }

  return Constructor;
};
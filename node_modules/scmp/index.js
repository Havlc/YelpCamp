<<<<<<< HEAD
'use strict'

const crypto = require('crypto')
const scmpCompare = require('./lib/scmpCompare')
=======
var crypto = require('crypto');
var scmpCompare = require('./lib/scmpCompare');
>>>>>>> e850dbdd69512603c0d4d12d8d93e241262e32af

/**
 * Does a constant-time Buffer comparison by not short-circuiting
 * on first sign of non-equivalency.
 *
 * @param {Buffer} a The first Buffer to be compared against the second
 * @param {Buffer} b The second Buffer to be compared against the first
 * @return {Boolean}
 */
module.exports = function scmp (a, b) {
  // check that both inputs are buffers
  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {
<<<<<<< HEAD
    throw new Error('Both scmp args must be Buffers')
=======
    throw new Error('Both scmp args must be Buffers');
>>>>>>> e850dbdd69512603c0d4d12d8d93e241262e32af
  }

  // return early here if buffer lengths are not equal since timingSafeEqual
  // will throw if buffer lengths are not equal
  if (a.length !== b.length) {
<<<<<<< HEAD
    return false
=======
    return false;
>>>>>>> e850dbdd69512603c0d4d12d8d93e241262e32af
  }

  // use crypto.timingSafeEqual if available (since Node.js v6.6.0),
  // otherwise use our own scmp-internal function.
  if (crypto.timingSafeEqual) {
<<<<<<< HEAD
    return crypto.timingSafeEqual(a, b)
  }

  return scmpCompare(a, b)
}
=======
    return crypto.timingSafeEqual(a, b);
  }

  return scmpCompare(a, b);
};
>>>>>>> e850dbdd69512603c0d4d12d8d93e241262e32af

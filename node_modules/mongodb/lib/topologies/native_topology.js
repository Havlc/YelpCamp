'use strict';

<<<<<<< HEAD
const Topology = require('../core').Topology;
=======
const Topology = require('mongodb-core').Topology;
>>>>>>> e850dbdd69512603c0d4d12d8d93e241262e32af
const ServerCapabilities = require('./topology_base').ServerCapabilities;
const Cursor = require('../cursor');
const translateOptions = require('../utils').translateOptions;

class NativeTopology extends Topology {
  constructor(servers, options) {
    options = options || {};

    let clonedOptions = Object.assign(
      {},
      {
        cursorFactory: Cursor,
        reconnect: false,
        emitError: typeof options.emitError === 'boolean' ? options.emitError : true,
<<<<<<< HEAD
        maxPoolSize:
          typeof options.maxPoolSize === 'number'
            ? options.maxPoolSize
            : typeof options.poolSize === 'number'
            ? options.poolSize
            : 10,
        minPoolSize:
          typeof options.minPoolSize === 'number'
            ? options.minPoolSize
            : typeof options.minSize === 'number'
            ? options.minSize
            : 0,
=======
        size: typeof options.poolSize === 'number' ? options.poolSize : 5,
>>>>>>> e850dbdd69512603c0d4d12d8d93e241262e32af
        monitorCommands:
          typeof options.monitorCommands === 'boolean' ? options.monitorCommands : false
      }
    );

    // Translate any SSL options and other connectivity options
    clonedOptions = translateOptions(clonedOptions, options);

    // Socket options
    var socketOptions =
      options.socketOptions && Object.keys(options.socketOptions).length > 0
        ? options.socketOptions
        : options;

<<<<<<< HEAD
    // Translate all the options to the core types
    clonedOptions = translateOptions(clonedOptions, socketOptions);

    clonedOptions.serverApi = options.serverApi;

    clonedOptions.useUnifiedTopology = options.useUnifiedTopology;

    super(servers, clonedOptions);
=======
    // Translate all the options to the mongodb-core ones
    clonedOptions = translateOptions(clonedOptions, socketOptions);

    super(servers, clonedOptions);

    // Do we have an application specific string
    if (options.appname) {
      this.s.clientInfo.application = { name: options.appname };
    }
>>>>>>> e850dbdd69512603c0d4d12d8d93e241262e32af
  }

  capabilities() {
    if (this.s.sCapabilities) return this.s.sCapabilities;
    if (this.lastIsMaster() == null) return null;
    this.s.sCapabilities = new ServerCapabilities(this.lastIsMaster());
    return this.s.sCapabilities;
  }
<<<<<<< HEAD

  // Command
  command(ns, cmd, options, callback) {
    super.command(ns.toString(), cmd, options, callback);
  }

  // Insert
  insert(ns, ops, options, callback) {
    super.insert(ns.toString(), ops, options, callback);
  }

  // Update
  update(ns, ops, options, callback) {
    super.update(ns.toString(), ops, options, callback);
  }

  // Remove
  remove(ns, ops, options, callback) {
    super.remove(ns.toString(), ops, options, callback);
  }
=======
>>>>>>> e850dbdd69512603c0d4d12d8d93e241262e32af
}

module.exports = NativeTopology;
